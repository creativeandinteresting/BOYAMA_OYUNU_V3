<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>√áocuk Boyama Oyunu</title>
<style>
body { font-family:sans-serif; background:#FFF5F5; margin:0; padding:0;}
.container {max-width:900px; margin:auto; padding:20px;}
.header{text-align:center; margin-bottom:20px;}
.coloring-grid {display:flex; flex-wrap:wrap; gap:20px; justify-content:center;}
.coloring-card {background:#fff; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1); padding:10px; cursor:pointer;}
.coloring-preview {width:150px; height:150px; border:1px solid #ccc; display:flex; justify-content:center; align-items:center; margin-bottom:10px;}
.canvas-container {text-align:center; margin-top:20px; position:relative;}
canvas {border:1px solid #ccc; position:absolute; top:0; left:0;}
#template-svg {position:absolute; top:0; left:0; width:500px; height:350px; pointer-events:none;}
.color-palette {display:flex; justify-content:center; gap:10px; margin:10px 0;}
.color-btn {width:30px; height:30px; border-radius:50%; border:2px solid #444; cursor:pointer;}
.color-btn.active {border:3px solid #FF6B9D;}
.tools {display:flex; justify-content:center; gap:10px; margin:10px 0;}
</style>
</head>
<body>
<div class="container">
  <div id="home-screen">
    <div class="header"><h1>üé® Boyama Oyunu</h1></div>
    <div id="coloring-grid" class="coloring-grid"></div>
  </div>

  <div id="coloring-screen" class="hidden">
    <button onclick="goHome()">‚Üê Ana Sayfa</button>
    <h2 id="current-page-name"></h2>
    <div class="canvas-container" style="width:500px; height:350px; margin:auto;">
      <svg id="template-svg" viewBox="0 0 500 350"></svg>
      <canvas id="drawing-canvas" width="500" height="350"></canvas>
    </div>
    <div class="color-palette" id="color-palette"></div>
    <div class="tools">
      <button onclick="clearCanvas()">üóëÔ∏è Temizle</button>
      <button onclick="undoLast()">‚Ü∂ Geri Al</button>
      <label>Fƒ±r√ßa boyutu: <input type="range" id="brush-size" min="5" max="25" value="5"></label>
    </div>
  </div>
</div>

<script>
// --- Boyama sayfalarƒ± ---
let coloringPages = [
  {id:'cat', name:'Kedi', file:'cat.svg'},
  {id:'car', name:'Araba', file:'car.svg'},
  {id:'flower', name:'√ái√ßek', file:'flower.svg'}
];

// --- Renk paleti ---
let colors = ['#FF0000','#00FF00','#0000FF','#FFFF00','#FF00FF','#00FFFF','#000000','#FFFFFF'];

// --- Canvas ve state ---
let canvas, ctx, paths=[], currentPath=[], drawing=false;
let selectedColor = colors[0];
let selectedBrushSize = 5;

// --- Ba≈ülat ---
document.addEventListener('DOMContentLoaded',()=>{
  canvas=document.getElementById('drawing-canvas');
  ctx=canvas.getContext('2d');
  ctx.lineCap='round';
  ctx.lineJoin='round';
  ctx.strokeStyle=selectedColor;
  ctx.lineWidth=selectedBrushSize;

  loadColoringPages();
  setupColorPalette();
  setupCanvasEvents();
  document.getElementById('brush-size').addEventListener('input', e=>{
    selectedBrushSize = e.target.value;
    ctx.lineWidth = selectedBrushSize;
  });
});

// --- Y√ºkleme ---
function loadColoringPages(){
  const grid=document.getElementById('coloring-grid');
  coloringPages.forEach(p=>{
    const card=document.createElement('div'); card.className='coloring-card';
    card.innerHTML=`<div class="coloring-preview"><img src="${p.file}" style="width:100%; height:100%; object-fit:contain;"></div><h3>${p.name}</h3>`;
    card.onclick=()=>openColoringPage(p.file,p.name);
    grid.appendChild(card);
  });
}

// --- A√ß ---
async function openColoringPage(file,name){
  document.getElementById('current-page-name').textContent=name;
  const svgContent = await fetch(file).then(r=>r.text());
  document.getElementById('template-svg').innerHTML = svgContent;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  paths=[];
  document.getElementById('home-screen').classList.add('hidden');
  document.getElementById('coloring-screen').classList.remove('hidden');
}

// --- Geri ---
function goHome(){
  document.getElementById('coloring-screen').classList.add('hidden');
  document.getElementById('home-screen').classList.remove('hidden');
}

// --- Renk paleti ---
function setupColorPalette(){
  const palette=document.getElementById('color-palette');
  colors.forEach(c=>{
    const btn=document.createElement('div'); btn.className='color-btn'; btn.style.background=c;
    if(c===selectedColor) btn.classList.add('active');
    btn.onclick=()=>{selectedColor=c; ctx.strokeStyle=c; document.querySelectorAll('.color-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active');};
    palette.appendChild(btn);
  });
}

// --- Canvas events ---
function setupCanvasEvents(){
  canvas.addEventListener('mousedown',e=>{drawing=true; currentPath=[getPos(e)]; ctx.beginPath(); ctx.moveTo(currentPath[0].x,currentPath[0].y);});
  canvas.addEventListener('mousemove',e=>{if(!drawing) return; const pos=getPos(e); currentPath.push(pos); ctx.lineTo(pos.x,pos.y); ctx.stroke();});
  canvas.addEventListener('mouseup',stopDrawing);
  canvas.addEventListener('mouseout',stopDrawing);

  canvas.addEventListener('touchstart',e=>{e.preventDefault(); drawing=true; const pos=getPos(e); currentPath=[pos]; ctx.beginPath(); ctx.moveTo(pos.x,pos.y);});
  canvas.addEventListener('touchmove',e=>{e.preventDefault(); if(!drawing) return; const pos=getPos(e); currentPath.push(pos); ctx.lineTo(pos.x,pos.y); ctx.stroke();});
  canvas.addEventListener('touchend',stopDrawing);
}

function getPos(e){
  const rect=canvas.getBoundingClientRect();
  let x,y;
  if(e.touches) { x=e.touches[0].clientX-rect.left; y=e.touches[0].clientY-rect.top; }
  else { x=e.clientX-rect.left; y=e.clientY-rect.top; }
  return {x:x*(canvas.width/rect.width), y:y*(canvas.height/rect.height)};
}

function stopDrawing(){ if(!drawing) return; drawing=false; if(currentPath.length>0){ paths.push({points:[...currentPath], color:selectedColor, size:selectedBrushSize}); } currentPath=[];}

// --- Temizle / geri al ---
function clearCanvas(){ ctx.clearRect(0,0,canvas.width,canvas.height); paths=[]; }
function undoLast(){ paths.pop(); redrawCanvas(); }
function redrawCanvas(){ ctx.clearRect(0,0,canvas.width,canvas.height); paths.forEach(p=>{ctx.strokeStyle=p.color; ctx.lineWidth=p.size; ctx.beginPath(); ctx.moveTo(p.points[0].x,p.points[0].y); for(let i=1;i<p.points.length;i++) ctx.lineTo(p.points[i].x,p.points[i].y); ctx.stroke(); }); ctx.strokeStyle=selectedColor; ctx.lineWidth=selectedBrushSize; }
</script>
</body>
</html>
